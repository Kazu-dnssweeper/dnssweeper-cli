# 🔒 セキュリティポリシー

## サポートされているバージョン

現在サポートされているDNSweeper CLIのバージョン：

| バージョン | サポート状況       |
| ---------- | ------------------ |
| 0.1.x      | :white_check_mark: |
| < 0.1.0    | :x:                |

## 脆弱性の報告

DNSweeper CLIのセキュリティ脆弱性を発見した場合は、以下の手順で報告してください。

### 報告方法

1. **公開しない**: 脆弱性の詳細をGitHub Issues等で公開しないでください
2. **メール送信**: security@dnssweeper.example.com に詳細を送信（※実際のメールアドレスを設定してください）
3. **暗号化推奨**: 可能であればPGPで暗号化してください

### 報告に含めるべき情報

- 脆弱性の種類（XSS、インジェクション、etc）
- 影響を受けるバージョン
- 再現手順
- 想定される影響範囲
- 可能であれば修正案

### 対応プロセス

1. **受領確認**: 48時間以内に受領確認を返信します
2. **初期評価**: 7日以内に脆弱性の評価を行います
3. **修正作業**: 重要度に応じて修正を実施します
   - Critical: 24時間以内
   - High: 7日以内
   - Medium: 30日以内
   - Low: 次回リリース時
4. **情報公開**: 修正完了後、適切なタイミングで情報を公開します

## セキュリティベストプラクティス

### DNSweeper CLI使用時の注意点

1. **APIキーの管理**
   ```bash
   # ❌ 悪い例
   dnssweeper analyze --api-key=sk-1234567890
   
   # ✅ 良い例
   export CLOUDFLARE_API_KEY=sk-1234567890
   dnssweeper analyze
   ```

2. **CSVファイルの取り扱い**
   - DNS情報は機密情報を含む可能性があります
   - 分析後のファイルは適切に削除してください
   - 公開リポジトリにCSVファイルをコミットしないでください

3. **出力ファイルの保護**
   ```bash
   # 出力ファイルの権限を制限
   dnssweeper analyze data.csv -o results.csv
   chmod 600 results.csv
   ```

## セキュリティ機能

### 実装済みのセキュリティ対策

1. **読み取り専用設計**
   - DNSレコードの削除・変更機能なし
   - 誤操作によるデータ破壊を防止

2. **入力検証**
   - CSVファイルの検証
   - コマンドライン引数のサニタイズ
   - パスインジェクション対策

3. **依存関係の管理**
   - npm auditによる定期チェック
   - Dependabotによる自動更新
   - 最小限の依存関係

4. **エラーハンドリング**
   - スタックトレースの隠蔽
   - 適切なエラーメッセージ

## 責任ある開示

セキュリティ研究者の皆様へ：

1. 責任ある開示にご協力ください
2. 修正に必要な合理的な時間をください
3. 協力いただいた方はCREDITS.mdに記載させていただきます

## 連絡先

- セキュリティチーム: security@dnssweeper.example.com
- PGPキー: [公開鍵のURL]

---

最終更新: 2025年7月10日